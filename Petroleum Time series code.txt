install.packages("readxl")
library(forecast)
library(ggplot2)
library("readxl")
time <- read_excel(file.choose())
install.packages("readxl")
library("readxl")
time <- read_excel(file.choose())
install.packages("fpp2")

library(fpp2)
Y<-ts(time[,2],start=c(1973,1),frequency=12)
 library(forecast)
library(ggplot2)
autoplot(Y)+ggtitle("Time Plot: Distillate Fuel Oil Refinery and Blender Net Production")+ylab("Thousand Barrels per day")

DY<-diff(Y)
autoplot(DY)+ggtitle("Time Plot: Change in Distillate Fuel Oil Refinery and Blender Net Production")+ylab("Thousand Barrels per day")
ggseasonplot(DY)+ggtitle("Season Plot: Change in daily Distillate Fuel Oil Refinery and Blender Net Production")+ylab("Thousand Barrels per day")
ggsubseriesplot(DY)
fit<-snaive(DY)
print(summary(fit))
checkresiduals(fit)
fit_ets<-ets(DY)
fit_ets<-ets(Y)
fit_ets(Y)
fit_ets<-ets(Y)

print(summary(fit_ets))

checkresiduals(fit_ets)
fit_arima<-auto.arima(Y,d=1,D=1,stepwise=FALSE,approximation=FALSE,trace=TRUE)
print(summary(fit_arima))
checkerresiduals(fit_arima)
checkresiduals(fit_arima)
fcst<-forecast(fit_arima,h=24)
autoplot(fcst)
print(summary(fcst))
